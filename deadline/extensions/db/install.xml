<?xml version="1.0" encoding="UTF-8"?>
<XMLDB PATH="deadline/extensions/db" VERSION="2013022602" COMMENT="XMLDB file for Moodle deadline/extensions" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../../lib/xmldb/xmldb.xsd">
    <TABLES>
        <TABLE NAME="deadline_extensions" COMMENT="Stores Extensions that have been added to the system." NEXT="deadline_extensions_history">
            <FIELDS>
                <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="TRUE" SEQUENCE="TRUE" COMMENT="ID field for tracking individual items" NEXT="ext_type" />
                <FIELD NAME="ext_type" TYPE="int" LENGTH="1" NOTNULL="TRUE" SEQUENCE="FALSE" DEFAULT="0" COMMENT="this field will be 0 for individual, 1 for global/class, 2 for group extension" PREVIOUS="id" NEXT="cm_id" />
                <FIELD NAME="cm_id" TYPE="int" LENGTH="10" NOTNULL="TRUE" SEQUENCE="FALSE" DEFAULT="0" COMMENT="Links this item to an existing Course Module ID" PREVIOUS="ext_type" NEXT="deadline_id" />
                <FIELD NAME="deadline_id" TYPE="int" LENGTH="10" NOTNULL="TRUE" SEQUENCE="FALSE" DEFAULT="0" COMMENT="Links this item to an existing Deadline ID" PREVIOUS="cm_id" NEXT="student_id" />
                <FIELD NAME="student_id" TYPE="int" LENGTH="10" NOTNULL="FALSE" SEQUENCE="FALSE" DEFAULT="0" COMMENT="Student MoodleID, creator for indiv &amp; group, null for global" PREVIOUS="deadline_id" NEXT="staff_id" />
                <FIELD NAME="staff_id" TYPE="int" LENGTH="10" NOTNULL="FALSE" SEQUENCE="FALSE" DEFAULT="0" COMMENT="Staff MoodleID, creator for global - person sent to for indiv" PREVIOUS="student_id" NEXT="request_text" />
                <FIELD NAME="request_text" TYPE="text" NOTNULL="FALSE" SEQUENCE="FALSE" COMMENT="Text provided in the request, or why the global was created." PREVIOUS="staff_id" NEXT="response_text" />
                <FIELD NAME="response_text" TYPE="text" NOTNULL="FALSE" SEQUENCE="FALSE" COMMENT="Text provided by a staff member" PREVIOUS="request_text" NEXT="date" />
                <FIELD NAME="date" TYPE="int" LENGTH="14" NOTNULL="TRUE" DEFAULT="0" SEQUENCE="FALSE" COMMENT="Date requested for the extension. 0 if Time extension for Quiz" PREVIOUS="response_text" NEXT="extratime" />
                <FIELD NAME="timelimit" TYPE="int" LENGTH="14" NOTNULL="TRUE" DEFAULT="0" SEQUENCE="FALSE" COMMENT="Time length extensions, specific to Quiz module. 0 if Date extension" PREVIOUS="date" NEXT="status" />
                <FIELD NAME="status" TYPE="int" LENGTH="2" NOTNULL="TRUE" DEFAULT="0" SEQUENCE="FALSE" COMMENT="Status of the request." PREVIOUS="timelimit" NEXT="created" />
                <FIELD NAME="created" TYPE="int" LENGTH="14" NOTNULL="TRUE" SEQUENCE="FALSE" COMMENT="Date the extension was created." PREVIOUS="status" />
            </FIELDS>
            <KEYS>
                <KEY NAME="primary" TYPE="primary" FIELDS="id" NEXT="student_id_fk1" />
                <KEY NAME="student_id_fk1" TYPE="foreign" FIELDS="student_id" REFTABLE="users" REFFIELDS="id" COMMENT="Links the request to a student" PREVIOUS="primary" NEXT="staff_id_fk2" />
                <KEY NAME="staff_id_fk2" TYPE="foreign" FIELDS="staff_id" REFTABLE="users" REFFIELDS="id" COMMENT="Links the request to a Staff member" PREVIOUS="student_id_fk1" NEXT="cm_id_fk3" />
                <KEY NAME="cm_id_fk3" TYPE="FOREIGN" FIELDS="cm_id" REFTABLE="course_modules" REFFIELDS="id" COMMENT="Links the request to a Course Module ID" PREVIOUS="staff_id_fk2" NEXT="deadline_id_fk4" />
                <KEY NAME="deadline_id_fk4" TYPE="FOREIGN" FIELDS="deadline_id" REFTABLE="deadlines" REFFIELDS="id" COMMENT="Links the request to a Deadline ID" PREVIOUS="cm_id_fk3" />
            </KEYS>
            <INDEXES>
                <INDEX NAME="extensions_id_idx" UNIQUE="false" FIELDS="id" NEXT="cm_id_idx" />
                <INDEX NAME="cm_id_idx" UNIQUE="false" FIELDS="cm_id" PREVIOUS="extensions_id_idx" NEXT="student_id_idx" />
                <INDEX NAME="student_id_idx" UNIQUE="false" FIELDS="student_id" PREVIOUS="cm_id_idx" NEXT="staff_id_idx" />
                <INDEX NAME="staff_id_idx" UNIQUE="false" FIELDS="staff_id" PREVIOUS="student_id_idx" />
            </INDEXES>
        </TABLE>
        <TABLE NAME="deadline_extensions_history" COMMENT="Table that tracks changes to individual Extensions. " PREVIOUS="deadline_extensions" NEXT="deadline_extensions_enabled">
            <FIELDS>
                <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="TRUE" SEQUENCE="TRUE" COMMENT="ID Field" NEXT="extension_id" />
                <FIELD NAME="extension_id" TYPE="int" LENGTH="10" NOTNULL="TRUE" SEQUENCE="FALSE" COMMENT="Extension this is the history for" PREVIOUS="id" NEXT="date" />
                <FIELD NAME="date" TYPE="int" LENGTH="14" NOTNULL="FALSE" DEFAULT="0" SEQUENCE="FALSE" COMMENT="The old extension date" PREVIOUS="extension_id" NEXT="request_text" />
                <FIELD NAME="request_text" TYPE="text" NOTNULL="FALSE" SEQUENCE="FALSE" COMMENT="The old Request Text when it was changed" PREVIOUS="date" NEXT="response_text" />
                <FIELD NAME="response_text" TYPE="text" NOTNULL="FALSE" SEQUENCE="FALSE" COMMENT="The old text provided by a staff member" PREVIOUS="request_text" NEXT="status" />
                <FIELD NAME="status" TYPE="int" LENGTH="2" NOTNULL="TRUE" SEQUENCE="FALSE" COMMENT="The new Status in this request" PREVIOUS="response_text" NEXT="change_date" />
                <FIELD NAME="change_date" TYPE="int" LENGTH="14" NOTNULL="TRUE" SEQUENCE="FALSE" COMMENT="Date the change was made" PREVIOUS="status" NEXT="staff_id" />
                <FIELD NAME="staff_id" TYPE="int" LENGTH="10" NOTNULL="FALSE" SEQUENCE="FALSE" DEFAULT="0" COMMENT="Staff MoodleID, creator for global - person sent to for indiv" PREVIOUS="change_date" NEXT="user_id" />
                <FIELD NAME="user_id" TYPE="int" LENGTH="10" NOTNULL="TRUE" SEQUENCE="FALSE" COMMENT="The user ID that made the change" PREVIOUS="staff_id" />
            </FIELDS>
            <KEYS>
                <KEY NAME="primary" TYPE="primary" FIELDS="id" NEXT="extension_id_fk1" />
                <KEY NAME="extension_id_fk1" TYPE="foreign" FIELDS="extension_id" REFTABLE="extensions" REFFIELDS="id" PREVIOUS="primary" NEXT="user_id_fk2" />
                <KEY NAME="user_id_fk2" TYPE="foreign" FIELDS="user_id" REFTABLE="users" REFFIELDS="id" PREVIOUS="extension_id_fk1" />
            </KEYS>
            <INDEXES>
                <INDEX NAME="extensions_hist_idx" UNIQUE="false" FIELDS="id" />
            </INDEXES>
        </TABLE>
        <TABLE NAME="deadline_extensions_enabled" COMMENT="Table that tracks activities with extensions permitted" PREVIOUS="deadline_extensions_history" NEXT="deadline_extensions_appto">
            <FIELDS>
                <FIELD SEQUENCE="true" TYPE="int" LENGTH="10" NOTNULL="true" NAME="id" COMMENT="ID field for this item" NEXT="cm_id" />
                <FIELD SEQUENCE="false" TYPE="int" LENGTH="10" NOTNULL="true" NAME="cm_id" COMMENT="Course Module ID this extension relates to" PREVIOUS="id" NEXT="status" />
                <FIELD SEQUENCE="false" TYPE="int" LENGTH="1" NOTNULL="true" NAME="status" DEFAULT="0" COMMENT="Status of this item" PREVIOUS="cm_id" NEXT="date_enabled" />
                <FIELD SEQUENCE="false" TYPE="int" LENGTH="14" NOTNULL="true" NAME="date_enabled" COMMENT="Date/Time the extensions were allowed" PREVIOUS="status" NEXT="request_cutoff" />
                <FIELD SEQUENCE="false" TYPE="int" LENGTH="14" NOTNULL="true" NAME="request_cutoff" DEFAULT="0" COMMENT="Hours Prior to the deadline the extensions are stopped" PREVIOUS="date_enabled" NEXT="staff_id" />
                <FIELD SEQUENCE="false" TYPE="int" LENGTH="10" NOTNULL="true" NAME="staff_id" DEFAULT="0" COMMENT="Staff Member who permitted extensions to be requested." PREVIOUS="request_cutoff" />
            </FIELDS>
            <KEYS>
                <KEY NAME="primary" TYPE="primary" FIELDS="id" NEXT="cm_id_fk1" />
                <KEY NAME="cm_id_fk1" TYPE="foreign" FIELDS="cm_id" REFTABLE="course_modules" REFFIELDS="id" COMMENT="Foreign Key for Course Module ID" PREVIOUS="primary" NEXT="staff_id_fk2" />
                <KEY NAME="staff_id_fk2" TYPE="foreign" FIELDS="staff_id" REFTABLE="users" REFFIELDS="id" COMMENT="Staff Member who allowed extensions to be requested" PREVIOUS="cm_id_fk1" />
            </KEYS>
            <INDEXES>
                <INDEX NAME="extensions_enabled_idx1" UNIQUE="false" FIELDS="id" NEXT="extensions_enabled_idx2" />
                <INDEX NAME="extensions_enabled_idx2" UNIQUE="false" FIELDS="cm_id" PREVIOUS="extensions_enabled_idx1" />
            </INDEXES>
        </TABLE>
        <TABLE NAME="deadline_extensions_appto" COMMENT="Table storing specific Groups which an extension is applied to in Global Extension mode." PREVIOUS="deadline_extensions_enabled" NEXT="deadline_extensions_appv">
            <FIELDS> 
                <FIELD SEQUENCE="TRUE" TYPE="INT" LENGTH="10" NOTNULL="TRUE" NAME="id" COMMENT="ID Field for this record" NEXT="ext_id"/>
                <FIELD SEQUENCE="FALSE" TYPE="INT" LENGTH="10" NOTNULL="TRUE" NAME="ext_id" COMMENT="Extension ID from deadlines_extensions table this refers to" PREVIOUS="id" NEXT="group_id" />
                <FIELD SEQUENCE="FALSE" TYPE="INT" LENGTH="10" NOTNULL="TRUE" NAME="group_id" COMMENT="Group ID that this extension applies to" PREVIOUS="ext_id" />
            </FIELDS>
            <KEYS>
                <KEY NAME="primary" TYPE="primary" FIELDS="id" NEXT="ext_id_fk1" />
                <KEY NAME="ext_id_fk1" TYPE="foreign" FIELDS="ext_id" REFTABLE="deadline_extensions" REFFIELDS="id" PREVIOUS="primary" NEXT="group_id_fk2" />
                <KEY NAME="group_id_fk2" TYPE="foreign" FIELDS="group_id" REFTABLE="groups" REFFIELDS="id" PREVIOUS="ext_id_fk1"/>
            </KEYS>
            <INDEXES>
                <INDEX NAME="extensions_appto_idx1" UNIQUE="false" FIELDS="id" NEXT="extensions_appto_idx2" />
                <INDEX NAME="extensions_appto_idx2" UNIQUE="false" FIELDS="group_id" PREVIOUS="extensions_appto_idx1" />
            </INDEXES>
        </TABLE>
        <!-- TABLE OF USERS WHO CAN APPROVE EXTENSIONS FOR AN ACTIVITY -->
        <TABLE NAME="deadline_extensions_appv" COMMENT="Table storing users who are approvers for a specific activity." PREVIOUS="deadline_extensions_appto">
            <FIELDS>
                <FIELD SEQUENCE="true" TYPE="int" LENGTH="10" NOTNULL="true" NAME="id" COMMENT="ID Field for this approver" NEXT="ext_en_id" />
                <FIELD SEQUENCE="false" TYPE="int" LENGTH="10" NOTNULL="true" NAME="ext_en_id" COMMENT="Parent extensions enable field this relates to" PREVIOUS="id" NEXT="user_id" />
                <FIELD SEQUENCE="false" TYPE="int" LENGTH="10" NOTNULL="true" NAME="user_id" COMMENT="User ID who is an extension approver for this activity." PREVIOUS="ext_en_id"/>
            </FIELDS>
            <KEYS>
                <KEY NAME="primary" TYPE="primary" FIELDS="id" NEXT="ext_en_id_fk1" />
                <KEY NAME="ext_en_id_fk1" TYPE="foreign" FIELDS="ext_en_id" REFTABLE="deadline_extensions_enabled" REFFIELDS="id" PREVIOUS="primary" NEXT="user_id_fk2" />
                <KEY NAME="user_id_fk2" TYPE="foreign" FIELDS="user_id" REFTABLE="users" REFFIELDS="id" PREVIOUS="ext_en_id_fk1"/>
            </KEYS>
            <INDEXES>
                <INDEX NAME="ext_appr_idx1" UNIQUE="false" FIELDS="id" />
            </INDEXES>
        </TABLE>
        <!-- DOCUMENTS FOR A INDIVIDUAL REQUEST. -->
        <!-- <TABLE> </TABLE> -->
    </TABLES>
</XMLDB>